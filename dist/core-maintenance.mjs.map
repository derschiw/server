{"version":3,"file":"core-maintenance.mjs","sources":["../core/src/maintenance.js"],"sourcesContent":["/**\n * @copyright 2019 Christoph Wurst <christoph@winzerhof-wurst.at>\n *\n * @author Christoph Wurst <christoph@winzerhof-wurst.at>\n * @author John Molakvo√¶ <skjnldsv@protonmail.com>\n * @author Roeland Jago Douma <roeland@famdouma.nl>\n *\n * @license AGPL-3.0-or-later\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Affero General Public License as\n * published by the Free Software Foundation, either version 3 of the\n * License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Affero General Public License for more details.\n *\n * You should have received a copy of the GNU Affero General Public License\n * along with this program. If not, see <http://www.gnu.org/licenses/>.\n *\n */\n\nimport Axios from '@nextcloud/axios'\nimport { getRootUrl } from '@nextcloud/router'\n\nconst url = getRootUrl() + '/status.php'\n\nconst check = () => {\n\tconsole.info('checking the Nextcloud maintenance status')\n\tAxios.get(url)\n\t\t.then(resp => resp.data)\n\t\t.then(status => {\n\t\t\tif (status.maintenance === false) {\n\t\t\t\tconsole.info('Nextcloud is not in maintenance mode anymore -> reloading')\n\n\t\t\t\twindow.location.reload()\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tconsole.info('Nextcloud is still in maintenance mode')\n\n\t\t\t// Wait 20sec before the next request\n\t\t\tsetTimeout(check, 20 * 1000)\n\t\t})\n\t\t.catch(console.error.bind(this))\n}\n\n// Off we go!\ncheck()\n"],"names":["url","getRootUrl","check","Axios","resp","status","this"],"mappings":";+CA2BA,MAAMA,EAAMC,EAAU,EAAK,cAErBC,EAAQ,IAAM,CACnB,QAAQ,KAAK,2CAA2C,EACxDC,EAAM,IAAIH,CAAG,EACX,KAAKI,GAAQA,EAAK,IAAI,EACtB,KAAKC,GAAU,CACf,GAAIA,EAAO,cAAgB,GAAO,CACjC,QAAQ,KAAK,2DAA2D,EAExE,OAAO,SAAS,OAAQ,EACxB,MACA,CAED,QAAQ,KAAK,wCAAwC,EAGrD,WAAWH,EAAO,GAAK,GAAI,CAC9B,CAAG,EACA,MAAM,QAAQ,MAAM,KAAKI,MAAI,CAAC,CACjC,EAGAJ,EAAK"}